<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>BioPAN Tutorial</title>

<script src="rmarkdown_libs/header-attrs-2.7/header-attrs.js"></script>
<script src="rmarkdown_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="rmarkdown_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="rmarkdown_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="rmarkdown_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="rmarkdown_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="rmarkdown_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="rmarkdown_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="rmarkdown_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="rmarkdown_libs/navigation-1.1/tabsets.js"></script>
<script src="rmarkdown_libs/navigation-1.1/codefolding.js"></script>
<script src="rmarkdown_libs/navigation-1.1/sourceembed.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>

<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore"><strong>BioPAN Tutorial</strong></h1>
<h3 class="subtitle">This document was prepared on 2021-05-24.</h3>

</div>


<!-- 
!!!! IMPORTANT: run `source("utils/render.R")` to publish instead of clicking on 'Knit'
# See https://yihui.org/knitr/options/
-->
<div id="agenda" class="section level1">
<h1>Agenda</h1>
<p>This document helps to explain how the number displayed in the BioPAN software are calculated using a small dataset as an example. The source code of this document can be found in this <a href="https://github.com/JauntyJJS/BioPAN_Tutorial">GitHub respository</a></p>
</div>
<div id="about-biopan" class="section level1">
<h1>About BioPAN</h1>
<p><a href="https://f1000research.com/articles/10-4">BioPAN</a> <span class="citation">(1)</span> is a tool found in <a href="https://lipidmaps.org/biopan">LIPID MAPS</a> designed to automate biosynthetic pathway analysis of lipids.</p>
<p><img src="figures/giz061_ActivePCtoPStoPE_pathway.PNG" /></p>
<p>Below is a <a href="https://www.youtube.com/watch?v=EfTC_LuR3ak">YouTube video</a> on how to use BioPAN.</p>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/EfTC_LuR3ak" frameborder="0" allowfullscreen>
</iframe>
</p>
<p>The <a href="https://www.lipidmaps.org/biopan/doc/step3_build.html">documentation</a> of BioPAN provides a technical explanation of how the pathway scores are calculated.</p>
<p><img src="figures/giz061_BioPAN_techincal_details.PNG" /></p>
<p>More information can be found in this <a href="https://doi.org/10.1016/j.copbio.2016.10.003">paper</a> <span class="citation">(2)</span></p>
</div>
<div id="packages" class="section level1">
<h1>Packages</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(report<span class="sc">::</span><span class="fu">report</span>(<span class="fu">sessionInfo</span>()))</span></code></pre></div>
<p>The analysis was done using the R Statistical language (v4.0.5; R Core Team, 2021) on Windows 10 x64, using the packages dplyr (v1.0.6), rmarkdown (v2.7), report (v0.3.0) and magrittr (v2.0.1).</p>
</div>
<div id="data" class="section level1 tabset">
<h1 class="tabset">Data</h1>
<p>The data used in this tutorial is taken from this <a href="https://academic.oup.com/gigascience/article/8/6/giz061/5505544">paper</a> <span class="citation">(3)</span></p>
<div id="download-data" class="section level2">
<h2>Download Data</h2>
<p>To download the data, scroll down to the “Supplementary data” Section and click on “giz061_Supplemental_Files”</p>
<p><img src="figures/giz061_Supplemental_Files.PNG" /></p>
<p>Unzip the folder and go to Supplemental Data 6.csv</p>
<p><img src="figures/giz061_Supplemental_Data6.PNG" /></p>
</div>
<div id="data-preview" class="section level2">
<h2>Data Preview</h2>
<p>The data should look like this when opened</p>
<p><img src="figures/giz061_Supplemental_Data6_open.PNG" /></p>
<p>For this tutorial, a small subset is used</p>
<p><img src="figures/giz061_Supplemental_Data6_subset.PNG" /></p>
</div>
<div id="data-description" class="section level2">
<h2>Data Description</h2>
<p>Description for each column can be found <a href="http://gigadb.org/dataset/view/id/100599/Sample_page/2">here</a></p>
<p><img src="figures/giz061_Supplemental_Files_SampleDescription.PNG" /></p>
</div>
</div>
<div id="biopan-on-lipid-species" class="section level1 tabset">
<h1 class="tabset">BioPAN on Lipid Species</h1>
<div id="active-case" class="section level2">
<h2>Active Case</h2>
<p>Let us consider the pathway of <code>PS(42:8)</code> to <code>PE(42:8)</code> to <code>PC(42:8)</code>.</p>
<p><img src="figures/giz061_Active42_8_pathway.PNG" /></p>
<p>The dataset are as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;24h CON&quot;</span>, <span class="st">&quot;24h CON&quot;</span>, <span class="st">&quot;24h CON&quot;</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;24h AA&quot;</span>, <span class="st">&quot;24h AA&quot;</span>, <span class="st">&quot;24h AA&quot;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;CON&quot;</span>, <span class="st">&quot;CON&quot;</span>, <span class="st">&quot;CON&quot;</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;AA&quot;</span>, <span class="st">&quot;AA&quot;</span>, <span class="st">&quot;AA&quot;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>PS42_8 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.039096671</span>, <span class="fl">0.048629063</span>, <span class="fl">0.033723608</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.047177176</span>, <span class="fl">0.041427748</span>, <span class="fl">0.043042335</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>PE42_8 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.005358486</span>, <span class="fl">0.00509418</span>, <span class="fl">0.00489321</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.160215808</span>, <span class="fl">0.151076058</span>, <span class="fl">0.166159881</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>PC42_8 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.01543998</span>, <span class="fl">0.015312104</span>, <span class="fl">0.015252706</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.286319709</span>, <span class="fl">1.083053662</span>, <span class="fl">1.261169034</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>active_data <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sample =</span> samples,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">Group =</span> group,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">PS(42:8)</span><span class="st">`</span> <span class="ot">=</span> PS42_8,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">PE(42:8)</span><span class="st">`</span> <span class="ot">=</span> PE42_8,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">PC(42:8)</span><span class="st">`</span> <span class="ot">=</span> PC42_8</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>active_data</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">Sample</th>
<th align="left">Group</th>
<th align="right">PS(42:8)</th>
<th align="right">PE(42:8)</th>
<th align="right">PC(42:8)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.039</td>
<td align="right">0.005</td>
<td align="right">0.015</td>
</tr>
<tr class="even">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.049</td>
<td align="right">0.005</td>
<td align="right">0.015</td>
</tr>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.034</td>
<td align="right">0.005</td>
<td align="right">0.015</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.047</td>
<td align="right">0.160</td>
<td align="right">1.286</td>
</tr>
<tr class="odd">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.041</td>
<td align="right">0.151</td>
<td align="right">1.083</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.043</td>
<td align="right">0.166</td>
<td align="right">1.261</td>
</tr>
</tbody>
</table>
</div>
<div id="ps428-to-pe428" class="section level3">
<h3><code>PS(42:8)</code> to <code>PE(42:8)</code></h3>
<p><strong>Compute the weight for product <code>PE(42:8)</code> over reactant <code>PS(42:8)</code> for each sample.</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> (active_data<span class="sc">$</span><span class="st">`</span><span class="at">PE(42:8)</span><span class="st">`</span> <span class="sc">/</span> active_data<span class="sc">$</span><span class="st">`</span><span class="at">PS(42:8)</span><span class="st">`</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>active_data <span class="ot">&lt;-</span> active_data <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">PE(42:8) over PS(42:8)</span><span class="st">`</span> <span class="ot">=</span> weights)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>active_data <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PC(42:8)</span><span class="st">`</span>))</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">Sample</th>
<th align="left">Group</th>
<th align="right">PS(42:8)</th>
<th align="right">PE(42:8)</th>
<th align="right">PE(42:8) over PS(42:8)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.039</td>
<td align="right">0.005</td>
<td align="right">0.137</td>
</tr>
<tr class="even">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.049</td>
<td align="right">0.005</td>
<td align="right">0.105</td>
</tr>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.034</td>
<td align="right">0.005</td>
<td align="right">0.145</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.047</td>
<td align="right">0.160</td>
<td align="right">3.396</td>
</tr>
<tr class="odd">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.041</td>
<td align="right">0.151</td>
<td align="right">3.647</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.043</td>
<td align="right">0.166</td>
<td align="right">3.860</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Compute a one-sided Welch <span class="math inline">\(t\)</span>-test between the samples of interest (Group AA) and the control samples (Group CON).</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>aa_samples <span class="ot">&lt;-</span> active_data <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data<span class="sc">$</span>Group <span class="sc">==</span> <span class="st">&quot;AA&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PE(42:8) over PS(42:8)</span><span class="st">`</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>control_samples <span class="ot">&lt;-</span> active_data <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data<span class="sc">$</span>Group <span class="sc">==</span> <span class="st">&quot;CON&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PE(42:8) over PS(42:8)</span><span class="st">`</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(aa_samples, control_samples, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(t1)</span></code></pre></div>
<p>Effect sizes were labelled following Cohen’s (1988) recommendations.</p>
<p>The Welch Two Sample t-test testing the difference between aa_samples and control_samples (mean of x = 3.63, mean of y = 0.13) suggests that the effect is positive, statistically significant, and large (difference = 3.51, 95% CI [3.12, Inf], t(2.03) = 26.01, p &lt; .001; Cohen’s d = 21.24, 95% CI [3.37, 39.33])</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;$p$ value is&quot;</span>, <span class="fu">format</span>(t1<span class="sc">$</span>p.value, <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">nsmall =</span> <span class="dv">3</span>)))</span></code></pre></div>
<p><span class="math inline">\(p\)</span> value is 6.75e-04</p>
<p><strong>Convert the <span class="math inline">\(p\)</span> value into a <span class="math inline">\(Z\)</span> Score.</strong></p>
<p>This is also the pathway score for <code>PS(42:8)</code> to <code>PE(42:8)</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>z_score1 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> t1<span class="sc">$</span>p.value)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;$Z$ score for `PS(42:8)` to `PE(42:8)` is&quot;</span>, <span class="fu">format</span>(z_score1, <span class="at">nsmall =</span> <span class="dv">3</span>)))</span></code></pre></div>
<p><span class="math inline">\(Z\)</span> score for <code>PS(42:8)</code> to <code>PE(42:8)</code> is 3.205</p>
</div>
<div id="pe428-to-pc428" class="section level3">
<h3><code>PE(42:8)</code> to <code>PC(42:8)</code></h3>
<p><strong>Compute the weight for product <code>PC(42:8)</code> over reactant <code>PE(42:8)</code> for each sample.</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> (active_data<span class="sc">$</span><span class="st">`</span><span class="at">PC(42:8)</span><span class="st">`</span> <span class="sc">/</span> active_data<span class="sc">$</span><span class="st">`</span><span class="at">PE(42:8)</span><span class="st">`</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>active_data <span class="ot">&lt;-</span> active_data <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">PC(42:8) over PE(42:8)</span><span class="st">`</span> <span class="ot">=</span> weights)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>active_data <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PS(42:8)</span><span class="st">`</span>, .data<span class="sc">$</span><span class="st">`</span><span class="at">PE(42:8) over PS(42:8)</span><span class="st">`</span>))</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">Sample</th>
<th align="left">Group</th>
<th align="right">PE(42:8)</th>
<th align="right">PC(42:8)</th>
<th align="right">PC(42:8) over PE(42:8)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.005</td>
<td align="right">0.015</td>
<td align="right">2.88</td>
</tr>
<tr class="even">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.005</td>
<td align="right">0.015</td>
<td align="right">3.01</td>
</tr>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.005</td>
<td align="right">0.015</td>
<td align="right">3.12</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.160</td>
<td align="right">1.286</td>
<td align="right">8.03</td>
</tr>
<tr class="odd">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.151</td>
<td align="right">1.083</td>
<td align="right">7.17</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.166</td>
<td align="right">1.261</td>
<td align="right">7.59</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Compute a one-sided Welch <span class="math inline">\(t\)</span>-test between the samples of interest (Group AA) and the control samples (Group CON).</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>aa_samples <span class="ot">&lt;-</span> active_data <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data<span class="sc">$</span>Group <span class="sc">==</span> <span class="st">&quot;AA&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PC(42:8) over PE(42:8)</span><span class="st">`</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>control_samples <span class="ot">&lt;-</span> active_data <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data<span class="sc">$</span>Group <span class="sc">==</span> <span class="st">&quot;CON&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PC(42:8) over PE(42:8)</span><span class="st">`</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(aa_samples, control_samples, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(t2)</span></code></pre></div>
<p>Effect sizes were labelled following Cohen’s (1988) recommendations.</p>
<p>The Welch Two Sample t-test testing the difference between aa_samples and control_samples (mean of x = 7.60, mean of y = 3.00) suggests that the effect is positive, statistically significant, and large (difference = 4.59, 95% CI [3.91, Inf], t(2.30) = 17.85, p &lt; .001; Cohen’s d = 14.58, 95% CI [2.70, 27.26])</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;$p$ value is&quot;</span>, <span class="fu">format</span>(t2<span class="sc">$</span>p.value, <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">nsmall =</span> <span class="dv">3</span>)))</span></code></pre></div>
<p><span class="math inline">\(p\)</span> value is 8.11e-04</p>
<p><strong>Convert the <span class="math inline">\(p\)</span> value into a <span class="math inline">\(Z\)</span> score.</strong></p>
<p>This is also the pathway score for <code>PE(42:8)</code> to <code>PC(42:8)</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>z_score2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> t2<span class="sc">$</span>p.value)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;$Z$ score for `PE(42:8)` to `PC(42:8)` is&quot;</span>, <span class="fu">format</span>(z_score2, <span class="at">nsmall =</span> <span class="dv">3</span>)))</span></code></pre></div>
<p><span class="math inline">\(Z\)</span> score for <code>PE(42:8)</code> to <code>PC(42:8)</code> is 3.152</p>
<p><strong>Compute <span class="math inline">\(Z_{A}\)</span> for pathway <code>PS(42:8)</code> to <code>PE(42:8)</code> to <code>PC(42:8)</code>.</strong></p>
<p>Recall the formula is defined as:</p>
<p><img src="figures/giz061_BioPAN_ZA_score.PNG" /></p>
<p>where <span class="math inline">\(k\)</span> is 2 and <span class="math inline">\(Z_{i}\)</span> are the pathway scores <code>PS(42:8)</code> to <code>PE(42:8)</code> and <code>PE(42:8)</code> to <code>PC(42:8)</code> computed earlier.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>z_a <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)) <span class="sc">*</span> (z_score1 <span class="sc">+</span> z_score2)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;$Z_{A}$ is&quot;</span>, <span class="fu">format</span>(z_a, <span class="at">nsmall =</span> <span class="dv">3</span>)))</span></code></pre></div>
<p><span class="math inline">\(Z_{A}\)</span> is 4.495</p>
<p>With this settings,</p>
<p><img src="figures/giz061_Pvalue_0_05.PNG" /></p>
<p>Since <span class="math inline">\(Z_{A} &gt; 1.645\)</span>, the pathway is classified as active.</p>
</div>
</div>
<div id="suppressed-case" class="section level2">
<h2>Suppressed Case</h2>
<p>Let us consider the pathway of <code>PS(32:0)</code> to <code>PE(32:0)</code> to <code>PC(32:0)</code>.</p>
<p><img src="figures/giz061_Suppressed32_0_pathway.PNG" /></p>
<p>The dataset are as follows:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;24h CON&quot;</span>, <span class="st">&quot;24h CON&quot;</span>, <span class="st">&quot;24h CON&quot;</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;24h AA&quot;</span>, <span class="st">&quot;24h AA&quot;</span>, <span class="st">&quot;24h AA&quot;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;CON&quot;</span>, <span class="st">&quot;CON&quot;</span>, <span class="st">&quot;CON&quot;</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;AA&quot;</span>, <span class="st">&quot;AA&quot;</span>, <span class="st">&quot;AA&quot;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>PS32_0 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.11392858</span>, <span class="fl">0.080762026</span>, <span class="fl">0.128541348</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.656895224</span>, <span class="fl">0.800790573</span>, <span class="fl">0.592724899</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>PE32_0 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.046063214</span>, <span class="fl">0.043759251</span>, <span class="fl">0.047335343</span>,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.175927791</span>, <span class="fl">0.183855506</span>, <span class="fl">0.194325215</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>PC32_0_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.074150848</span>, <span class="fl">0.726798053</span>, <span class="fl">0.412228743</span>,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.94494173</span>, <span class="fl">1.520645133</span>, <span class="fl">1.337827826</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>PC32_0_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.928888882</span>, <span class="fl">0.964353269</span>, <span class="fl">0.789633482</span>,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.666428947</span>, <span class="fl">1.375398801</span>, <span class="fl">1.616097007</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>suppressed_data <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sample =</span> samples,</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">Group =</span> group,</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">PS(32:0)</span><span class="st">`</span> <span class="ot">=</span> PS32_0,</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">PE(32:0)</span><span class="st">`</span> <span class="ot">=</span> PE32_0,</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">PC(32:0) 1</span><span class="st">`</span> <span class="ot">=</span> PC32_0_1,</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">PC(32:0) 2</span><span class="st">`</span> <span class="ot">=</span> PC32_0_2</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>suppressed_data</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">Sample</th>
<th align="left">Group</th>
<th align="right">PS(32:0)</th>
<th align="right">PE(32:0)</th>
<th align="right">PC(32:0) 1</th>
<th align="right">PC(32:0) 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.114</td>
<td align="right">0.046</td>
<td align="right">1.074</td>
<td align="right">0.929</td>
</tr>
<tr class="even">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.081</td>
<td align="right">0.044</td>
<td align="right">0.727</td>
<td align="right">0.964</td>
</tr>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.129</td>
<td align="right">0.047</td>
<td align="right">0.412</td>
<td align="right">0.790</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.657</td>
<td align="right">0.176</td>
<td align="right">1.945</td>
<td align="right">1.666</td>
</tr>
<tr class="odd">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.801</td>
<td align="right">0.184</td>
<td align="right">1.521</td>
<td align="right">1.375</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.593</td>
<td align="right">0.194</td>
<td align="right">1.338</td>
<td align="right">1.616</td>
</tr>
</tbody>
</table>
</div>
<p>BioPAN will give a warning on the duplicated transition <code>PC(32:0)</code> and sum them up.</p>
<p><img src="figures/giz061_32_0_warning.PNG" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>suppressed_data <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sample =</span> samples,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Group =</span> group,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">PS(32:0)</span><span class="st">`</span> <span class="ot">=</span> PS32_0,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">PE(32:0)</span><span class="st">`</span> <span class="ot">=</span> PE32_0,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">PC(32:0)</span><span class="st">`</span> <span class="ot">=</span> PC32_0_1 <span class="sc">+</span> PC32_0_2</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>suppressed_data</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">Sample</th>
<th align="left">Group</th>
<th align="right">PS(32:0)</th>
<th align="right">PE(32:0)</th>
<th align="right">PC(32:0)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.114</td>
<td align="right">0.046</td>
<td align="right">2.00</td>
</tr>
<tr class="even">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.081</td>
<td align="right">0.044</td>
<td align="right">1.69</td>
</tr>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.129</td>
<td align="right">0.047</td>
<td align="right">1.20</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.657</td>
<td align="right">0.176</td>
<td align="right">3.61</td>
</tr>
<tr class="odd">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.801</td>
<td align="right">0.184</td>
<td align="right">2.90</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.593</td>
<td align="right">0.194</td>
<td align="right">2.95</td>
</tr>
</tbody>
</table>
</div>
<div id="ps320-to-pe320" class="section level3">
<h3><code>PS(32:0)</code> to <code>PE(32:0)</code></h3>
<p><strong>Compute the weight for product <code>PE(32:0)</code> over reactant <code>PS(32:0)</code> for each sample.</strong></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> (suppressed_data<span class="sc">$</span><span class="st">`</span><span class="at">PE(32:0)</span><span class="st">`</span> <span class="sc">/</span> suppressed_data<span class="sc">$</span><span class="st">`</span><span class="at">PS(32:0)</span><span class="st">`</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>suppressed_data <span class="ot">&lt;-</span> suppressed_data <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">PE(32:0) over PS(32:0)</span><span class="st">`</span> <span class="ot">=</span> weights)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>suppressed_data <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PC(32:0)</span><span class="st">`</span>))</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">Sample</th>
<th align="left">Group</th>
<th align="right">PS(32:0)</th>
<th align="right">PE(32:0)</th>
<th align="right">PE(32:0) over PS(32:0)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.114</td>
<td align="right">0.046</td>
<td align="right">0.404</td>
</tr>
<tr class="even">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.081</td>
<td align="right">0.044</td>
<td align="right">0.542</td>
</tr>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.129</td>
<td align="right">0.047</td>
<td align="right">0.368</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.657</td>
<td align="right">0.176</td>
<td align="right">0.268</td>
</tr>
<tr class="odd">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.801</td>
<td align="right">0.184</td>
<td align="right">0.230</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.593</td>
<td align="right">0.194</td>
<td align="right">0.328</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Compute a one-sided Welch <span class="math inline">\(t\)</span>-test between the samples of interest (Group AA) and the control samples (Group CON).</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>aa_samples <span class="ot">&lt;-</span> suppressed_data <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data<span class="sc">$</span>Group <span class="sc">==</span> <span class="st">&quot;AA&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PE(32:0) over PS(32:0)</span><span class="st">`</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>control_samples <span class="ot">&lt;-</span> suppressed_data <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data<span class="sc">$</span>Group <span class="sc">==</span> <span class="st">&quot;CON&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PE(32:0) over PS(32:0)</span><span class="st">`</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(aa_samples, control_samples, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(t1)</span></code></pre></div>
<p>Effect sizes were labelled following Cohen’s (1988) recommendations.</p>
<p>The Welch Two Sample t-test testing the difference between aa_samples and control_samples (mean of x = 0.28, mean of y = 0.44) suggests that the effect is negative, statistically significant, and large (difference = -0.16, 95% CI [-Inf, -0.02], t(3.08) = -2.71, p &lt; .05; Cohen’s d = -2.21, 95% CI [-4.46, 0.16])</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;$p$ value is&quot;</span>, <span class="fu">format</span>(t1<span class="sc">$</span>p.value, <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">nsmall =</span> <span class="dv">3</span>)))</span></code></pre></div>
<p><span class="math inline">\(p\)</span> value is 3.55e-02</p>
<p><strong>Convert the <span class="math inline">\(p\)</span> value into a <span class="math inline">\(Z\)</span> score.</strong></p>
<p>This is also the pathway score for <code>PS(32:0)</code> to <code>PE(32:0)</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>z_score1 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> t1<span class="sc">$</span>p.value)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;$Z$ score for`PS(32:0)` to `PE(32:0)` is&quot;</span>, <span class="fu">format</span>(z_score1, <span class="at">nsmall =</span> <span class="dv">3</span>)))</span></code></pre></div>
<p><span class="math inline">\(Z\)</span> score for<code>PS(32:0)</code> to <code>PE(32:0)</code> is 1.805</p>
</div>
<div id="pe320-to-pc320" class="section level3">
<h3><code>PE(32:0)</code> to <code>PC(32:0)</code></h3>
<p><strong>Compute the weight for product <code>PC(32:0)</code> over reactant <code>PE(32:0)</code> for each sample.</strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> (suppressed_data<span class="sc">$</span><span class="st">`</span><span class="at">PC(32:0)</span><span class="st">`</span> <span class="sc">/</span> suppressed_data<span class="sc">$</span><span class="st">`</span><span class="at">PE(32:0)</span><span class="st">`</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>suppressed_data <span class="ot">&lt;-</span> suppressed_data <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">PC(32:0) over PE(32:0)</span><span class="st">`</span> <span class="ot">=</span> weights)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>suppressed_data <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PS(32:0)</span><span class="st">`</span>, .data<span class="sc">$</span><span class="st">`</span><span class="at">PE(32:0) over PS(32:0)</span><span class="st">`</span>))</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">Sample</th>
<th align="left">Group</th>
<th align="right">PE(32:0)</th>
<th align="right">PC(32:0)</th>
<th align="right">PC(32:0) over PE(32:0)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.046</td>
<td align="right">2.00</td>
<td align="right">43.5</td>
</tr>
<tr class="even">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.044</td>
<td align="right">1.69</td>
<td align="right">38.6</td>
</tr>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.047</td>
<td align="right">1.20</td>
<td align="right">25.4</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.176</td>
<td align="right">3.61</td>
<td align="right">20.5</td>
</tr>
<tr class="odd">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.184</td>
<td align="right">2.90</td>
<td align="right">15.8</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.194</td>
<td align="right">2.95</td>
<td align="right">15.2</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Compute a one-sided Welch <span class="math inline">\(t\)</span>-test between the samples of interest (Group AA) and the control samples (Group CON).</strong></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>aa_samples <span class="ot">&lt;-</span> suppressed_data <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data<span class="sc">$</span>Group <span class="sc">==</span> <span class="st">&quot;AA&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PC(32:0) over PE(32:0)</span><span class="st">`</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>control_samples <span class="ot">&lt;-</span> suppressed_data <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data<span class="sc">$</span>Group <span class="sc">==</span> <span class="st">&quot;CON&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PC(32:0) over PE(32:0)</span><span class="st">`</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(aa_samples, control_samples, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(t2)</span></code></pre></div>
<p>Effect sizes were labelled following Cohen’s (1988) recommendations.</p>
<p>The Welch Two Sample t-test testing the difference between aa_samples and control_samples (mean of x = 17.16, mean of y = 35.84) suggests that the effect is negative, statistically significant, and large (difference = -18.68, 95% CI [-Inf, -3.83], t(2.39) = -3.30, p &lt; .05; Cohen’s d = -2.69, 95% CI [-5.41, 0.12])</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;$p$ value is&quot;</span>, <span class="fu">format</span>(t2<span class="sc">$</span>p.value, <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">nsmall =</span> <span class="dv">3</span>)))</span></code></pre></div>
<p><span class="math inline">\(p\)</span> value is 3.18e-02</p>
<p><strong>Convert the <span class="math inline">\(p\)</span> value into a <span class="math inline">\(Z\)</span> score.</strong></p>
<p>This is also the pathway score for <code>PE(32:0)</code> to <code>PC(32:0)</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>z_score2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> t2<span class="sc">$</span>p.value)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;$Z$ score for `PE(32:0)` to `PC(32:0)` is&quot;</span>, <span class="fu">format</span>(z_score2, <span class="at">nsmall =</span> <span class="dv">3</span>)))</span></code></pre></div>
<p><span class="math inline">\(Z\)</span> score for <code>PE(32:0)</code> to <code>PC(32:0)</code> is 1.856</p>
<p><strong>Compute <span class="math inline">\(Z_{A}\)</span> for pathway <code>PS(32:0)</code> to <code>PE(32:0)</code> to <code>PC(32:0)</code>.</strong></p>
<p>Recall the formula is defined as:</p>
<p><img src="figures/giz061_BioPAN_ZA_score.PNG" /></p>
<p>where <span class="math inline">\(k\)</span> is 2 and <span class="math inline">\(Z_{i}\)</span> are the pathway scores <code>PS(32:0)</code> to <code>PE(32:0)</code> and <code>PE(32:0)</code> to <code>PC(32:0)</code> computed earlier.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>z_a <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)) <span class="sc">*</span> (z_score1 <span class="sc">+</span> z_score2)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;$Z_{A}$ is&quot;</span>, <span class="fu">format</span>(z_a, <span class="at">nsmall =</span> <span class="dv">3</span>)))</span></code></pre></div>
<p><span class="math inline">\(Z_{A}\)</span> is 2.589</p>
<p>With this settings,</p>
<p><img src="figures/giz061_Pvalue_0_05.PNG" /></p>
<p>Since <span class="math inline">\(Z_{A} &gt; 1.645\)</span>, the pathway is classified as suppressed.</p>
</div>
</div>
</div>
<div id="biopan-on-lipid-class" class="section level1 tabset">
<h1 class="tabset">BioPAN on Lipid Class</h1>
<div id="active-case-1" class="section level2">
<h2>Active Case</h2>
<p>Let us consider the pathway of <code>PC</code> to <code>PS</code> to <code>PE</code>.</p>
<p><img src="figures/giz061_ActivePCtoPStoPE_pathway.PNG" /></p>
<p>The dataset are as follows:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;24h CON&quot;</span>, <span class="st">&quot;24h CON&quot;</span>, <span class="st">&quot;24h CON&quot;</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;24h AA&quot;</span>, <span class="st">&quot;24h AA&quot;</span>, <span class="st">&quot;24h AA&quot;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;CON&quot;</span>, <span class="st">&quot;CON&quot;</span>, <span class="st">&quot;CON&quot;</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;AA&quot;</span>, <span class="st">&quot;AA&quot;</span>, <span class="st">&quot;AA&quot;</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>PS42_8 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.039096671</span>, <span class="fl">0.048629063</span>, <span class="fl">0.033723608</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.047177176</span>, <span class="fl">0.041427748</span>, <span class="fl">0.043042335</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>PE42_8 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.005358486</span>, <span class="fl">0.00509418</span>, <span class="fl">0.00489321</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.160215808</span>, <span class="fl">0.151076058</span>, <span class="fl">0.166159881</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>PC42_8 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.01543998</span>, <span class="fl">0.015312104</span>, <span class="fl">0.015252706</span>,</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.286319709</span>, <span class="fl">1.083053662</span>, <span class="fl">1.261169034</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>PS32_0 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.11392858</span>, <span class="fl">0.080762026</span>, <span class="fl">0.128541348</span>,</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.656895224</span>, <span class="fl">0.800790573</span>, <span class="fl">0.592724899</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>PE32_0 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.046063214</span>, <span class="fl">0.043759251</span>, <span class="fl">0.047335343</span>,</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.175927791</span>, <span class="fl">0.183855506</span>, <span class="fl">0.194325215</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>PC32_0_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.074150848</span>, <span class="fl">0.726798053</span>, <span class="fl">0.412228743</span>,</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.94494173</span>, <span class="fl">1.520645133</span>, <span class="fl">1.337827826</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>PC32_0_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.928888882</span>, <span class="fl">0.964353269</span>, <span class="fl">0.789633482</span>,</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.666428947</span>, <span class="fl">1.375398801</span>, <span class="fl">1.616097007</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>active_data <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sample =</span> samples,</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">Group =</span> group,</span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">PS =</span> PS42_8 <span class="sc">+</span> PS32_0,</span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">PE =</span> PE42_8 <span class="sc">+</span> PE32_0,</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">PC =</span> PC42_8 <span class="sc">+</span> PC32_0_1 <span class="sc">+</span> PC32_0_2</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>active_data</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">Sample</th>
<th align="left">Group</th>
<th align="right">PS</th>
<th align="right">PE</th>
<th align="right">PC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.153</td>
<td align="right">0.051</td>
<td align="right">2.02</td>
</tr>
<tr class="even">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.129</td>
<td align="right">0.049</td>
<td align="right">1.71</td>
</tr>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.162</td>
<td align="right">0.052</td>
<td align="right">1.22</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.704</td>
<td align="right">0.336</td>
<td align="right">4.90</td>
</tr>
<tr class="odd">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.842</td>
<td align="right">0.335</td>
<td align="right">3.98</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.636</td>
<td align="right">0.360</td>
<td align="right">4.21</td>
</tr>
</tbody>
</table>
</div>
<div id="pc-to-ps" class="section level3">
<h3><code>PC</code> to <code>PS</code></h3>
<p><strong>Compute the weight for product <code>PS</code> over reactant <code>PC</code> for each sample.</strong></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> (active_data<span class="sc">$</span><span class="st">`</span><span class="at">PS</span><span class="st">`</span> <span class="sc">/</span> active_data<span class="sc">$</span><span class="st">`</span><span class="at">PC</span><span class="st">`</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>active_data <span class="ot">&lt;-</span> active_data <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">PS over PC</span><span class="st">`</span> <span class="ot">=</span> weights)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>active_data <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PE</span><span class="st">`</span>))</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">Sample</th>
<th align="left">Group</th>
<th align="right">PS</th>
<th align="right">PC</th>
<th align="right">PS over PC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.153</td>
<td align="right">2.02</td>
<td align="right">0.076</td>
</tr>
<tr class="even">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.129</td>
<td align="right">1.71</td>
<td align="right">0.076</td>
</tr>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.162</td>
<td align="right">1.22</td>
<td align="right">0.133</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.704</td>
<td align="right">4.90</td>
<td align="right">0.144</td>
</tr>
<tr class="odd">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.842</td>
<td align="right">3.98</td>
<td align="right">0.212</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.636</td>
<td align="right">4.21</td>
<td align="right">0.151</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Compute a one-sided Welch <span class="math inline">\(t\)</span>-test between the samples of interest (Group AA) and the control samples (Group CON).</strong></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>aa_samples <span class="ot">&lt;-</span> active_data <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data<span class="sc">$</span>Group <span class="sc">==</span> <span class="st">&quot;AA&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PS over PC</span><span class="st">`</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>control_samples <span class="ot">&lt;-</span> active_data <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data<span class="sc">$</span>Group <span class="sc">==</span> <span class="st">&quot;CON&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PS over PC</span><span class="st">`</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(aa_samples, control_samples, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(t1)</span></code></pre></div>
<p>Effect sizes were labelled following Cohen’s (1988) recommendations.</p>
<p>The Welch Two Sample t-test testing the difference between aa_samples and control_samples (mean of x = 0.17, mean of y = 0.09) suggests that the effect is positive, statistically significant, and large (difference = 0.07, 95% CI [0.01, Inf], t(3.95) = 2.56, p &lt; .05; Cohen’s d = 2.09, 95% CI [-0.11, 4.15])</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;$p$ value is&quot;</span>, <span class="fu">format</span>(t1<span class="sc">$</span>p.value, <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">nsmall =</span> <span class="dv">3</span>)))</span></code></pre></div>
<p><span class="math inline">\(p\)</span> value is 3.18e-02</p>
<p><strong>Convert the <span class="math inline">\(p\)</span> value into a <span class="math inline">\(Z\)</span> score.</strong></p>
<p>This is also the pathway score for <code>PC</code> to <code>PS</code>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>z_score1 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> t1<span class="sc">$</span>p.value)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;$Z$ score for `PC` to `PS` is&quot;</span>, <span class="fu">format</span>(z_score1, <span class="at">nsmall =</span> <span class="dv">3</span>)))</span></code></pre></div>
<p><span class="math inline">\(Z\)</span> score for <code>PC</code> to <code>PS</code> is 1.855</p>
</div>
<div id="ps-to-pe" class="section level3">
<h3><code>PS</code> to <code>PE</code></h3>
<p><strong>Compute the weight for product <code>PE</code> over reactant <code>PS</code> for each sample.</strong></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> (active_data<span class="sc">$</span><span class="st">`</span><span class="at">PE</span><span class="st">`</span> <span class="sc">/</span> active_data<span class="sc">$</span><span class="st">`</span><span class="at">PS</span><span class="st">`</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>active_data <span class="ot">&lt;-</span> active_data <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">PE over PS</span><span class="st">`</span> <span class="ot">=</span> weights)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>active_data <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PC</span><span class="st">`</span>, .data<span class="sc">$</span><span class="st">`</span><span class="at">PS over PC</span><span class="st">`</span>))</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">Sample</th>
<th align="left">Group</th>
<th align="right">PS</th>
<th align="right">PE</th>
<th align="right">PE over PS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.153</td>
<td align="right">0.051</td>
<td align="right">0.336</td>
</tr>
<tr class="even">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.129</td>
<td align="right">0.049</td>
<td align="right">0.378</td>
</tr>
<tr class="odd">
<td align="left">24h CON</td>
<td align="left">CON</td>
<td align="right">0.162</td>
<td align="right">0.052</td>
<td align="right">0.322</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.704</td>
<td align="right">0.336</td>
<td align="right">0.477</td>
</tr>
<tr class="odd">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.842</td>
<td align="right">0.335</td>
<td align="right">0.398</td>
</tr>
<tr class="even">
<td align="left">24h AA</td>
<td align="left">AA</td>
<td align="right">0.636</td>
<td align="right">0.360</td>
<td align="right">0.567</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Compute a one-sided Welch <span class="math inline">\(t\)</span>-test between the samples of interest (Group AA) and the control samples (Group CON).</strong></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>aa_samples <span class="ot">&lt;-</span> active_data <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data<span class="sc">$</span>Group <span class="sc">==</span> <span class="st">&quot;AA&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PE over PS</span><span class="st">`</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>control_samples <span class="ot">&lt;-</span> active_data <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.data<span class="sc">$</span>Group <span class="sc">==</span> <span class="st">&quot;CON&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(.data<span class="sc">$</span><span class="st">`</span><span class="at">PE over PS</span><span class="st">`</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(aa_samples, control_samples, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(t2)</span></code></pre></div>
<p>Effect sizes were labelled following Cohen’s (1988) recommendations.</p>
<p>The Welch Two Sample t-test testing the difference between aa_samples and control_samples (mean of x = 0.48, mean of y = 0.35) suggests that the effect is positive, statistically significant, and large (difference = 0.14, 95% CI [2.24e-03, Inf], t(2.46) = 2.62, p &lt; .05; Cohen’s d = 2.14, 95% CI [-0.31, 4.46])</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;$p$ value is&quot;</span>, <span class="fu">format</span>(t2<span class="sc">$</span>p.value, <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">nsmall =</span> <span class="dv">3</span>)))</span></code></pre></div>
<p><span class="math inline">\(p\)</span> value is 4.84e-02</p>
<p><strong>Convert the <span class="math inline">\(p\)</span> value into a <span class="math inline">\(Z\)</span> score.</strong></p>
<p>This is also the pathway score for <code>PS</code> to <code>PE</code>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>z_score2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> t2<span class="sc">$</span>p.value)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;$Z$ score for `PS` to `PE` is&quot;</span>, <span class="fu">format</span>(z_score2, <span class="at">nsmall =</span> <span class="dv">3</span>)))</span></code></pre></div>
<p><span class="math inline">\(Z\)</span> score for <code>PS</code> to <code>PE</code> is 1.660</p>
<p><strong>Compute <span class="math inline">\(Z_{A}\)</span> for pathway <code>PC</code> to <code>PS</code> to <code>PE</code>.</strong></p>
<p>Recall the formula is defined as:</p>
<p><img src="figures/giz061_BioPAN_ZA_score.PNG" /></p>
<p>where <span class="math inline">\(k\)</span> is 2 and <span class="math inline">\(Z_{i}\)</span> are the pathway scores <code>PC</code> to <code>PS</code> and <code>PS</code> to <code>PE</code> computed earlier.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>z_a <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)) <span class="sc">*</span> (z_score1 <span class="sc">+</span> z_score2)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;$Z_{A}$ is&quot;</span>, <span class="fu">format</span>(z_a, <span class="at">nsmall =</span> <span class="dv">4</span>)))</span></code></pre></div>
<p><span class="math inline">\(Z_{A}\)</span> is 2.4856</p>
<p>With this settings,</p>
<p><img src="figures/giz061_Pvalue_0_05.PNG" /></p>
<p>Since <span class="math inline">\(Z_{A} &gt; 1.645\)</span>, the pathway is classified as active.</p>
</div>
</div>
</div>
<div id="rmarkdown-template" class="section level1">
<h1>Rmarkdown Template</h1>
<p>This Rmarkdown template is created by the <a href="https://realitybending.github.io/">Reality Bending Lab</a>. The template can be download from the lab’s <a href="https://github.com/RealityBending/TemplateResults">github</a> repository. For more information about the motivation behind creating this template, check out <a href="https://dominiquemakowski.github.io/post/template_results/">Dr. Dominique Makowski’s blog post</a></p>
</div>
<div id="package-references" class="section level1">
<h1>Package References</h1>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>(<span class="fu">sessionInfo</span>())</span></code></pre></div>
<ul>
<li>Hadley Wickham, Romain François, Lionel Henry and Kirill Müller (2021). dplyr: A Grammar of Data Manipulation. R package version 1.0.6. <a href="https://CRAN.R-project.org/package=dplyr" class="uri">https://CRAN.R-project.org/package=dplyr</a></li>
<li>JJ Allaire and Yihui Xie and Jonathan McPherson and Javier Luraschi and Kevin Ushey and Aron Atkins and Hadley Wickham and Joe Cheng and Winston Chang and Richard Iannone (2021). rmarkdown: Dynamic Documents for R. R package version 2.7. URL <a href="https://rmarkdown.rstudio.com" class="uri">https://rmarkdown.rstudio.com</a>.</li>
<li>Makowski, D., Ben-Shachar, M.S., Patil, I. &amp; Lüdecke, D. (2020). Automated Results Reporting as a Practical Tool to Improve Reproducibility and Methodological Best Practices Adoption. CRAN. Available from <a href="https://github.com/easystats/report" class="uri">https://github.com/easystats/report</a>. doi: .</li>
<li>R Core Team (2021). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL <a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a>.</li>
<li>Stefan Milton Bache and Hadley Wickham (2020). magrittr: A Forward-Pipe Operator for R. R package version 2.0.1. <a href="https://CRAN.R-project.org/package=magrittr" class="uri">https://CRAN.R-project.org/package=magrittr</a></li>
</ul>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body">
<div id="ref-BIOPAN" class="csl-entry">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Gaud C, C. Sousa B, Nguyen A, Fedorova M, Ni Z, O’Donnell V, et al. BioPAN: A web-based tool to explore mammalian lipidome metabolic pathways on LIPID MAPS [version 1; peer review: 3 approved]. F1000Research [Internet]. 2021;10(4). Available from: <a href="https://f1000research.com/articles/10-4">https://f1000research.com/articles/10-4</a></div>
</div>
<div id="ref-NGUYEN201796" class="csl-entry">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Nguyen A, Rudge SA, Zhang Q, Wakelam MJ. Using lipidomics analysis to determine signalling and metabolic changes in cells. Current Opinion in Biotechnology [Internet]. 2017;43:96–103. Available from: <a href="https://www.sciencedirect.com/science/article/pii/S0958166916302233">https://www.sciencedirect.com/science/article/pii/S0958166916302233</a></div>
</div>
<div id="ref-LION" class="csl-entry">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Molenaar MR, Jeucken A, Wassenaar TA, Lest CHA van de, Brouwers JF, Helms JB. LION/web: A web-based ontology enrichment tool for lipidomic data analysis. GigaScience [Internet]. 2019 May;8(6). Available from: <a href="https://doi.org/10.1093/gigascience/giz061">https://doi.org/10.1093/gigascience/giz061</a></div>
</div>
</div>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogJyoqQmlvUEFOIFR1dG9yaWFsKionDQpzdWJ0aXRsZTogVGhpcyBkb2N1bWVudCB3YXMgcHJlcGFyZWQgb24gYHIgZm9ybWF0KFN5cy5EYXRlKCkpYC4NCm91dHB1dDoNCiAgaHRtbF9kb2N1bWVudDoNCiAgICB0aGVtZTogY2VydWxlYW4NCiAgICBoaWdobGlnaHQ6IHB5Z21lbnRzDQogICAgdG9jOiB5ZXMNCiAgICB0b2NfZGVwdGg6IDINCiAgICB0b2NfZmxvYXQ6DQogICAgICBjb2xsYXBzZWQ6IHRydWUNCiAgICAgIHNtb290aF9zY3JvbGw6IHRydWUNCiAgICBudW1iZXJfc2VjdGlvbnM6IG5vDQogICAgZGZfcHJpbnQ6IGthYmxlDQogICAgY29kZV9mb2xkaW5nOiBoaWRlDQogICAgY29kZV9kb3dubG9hZDogeWVzDQogICAgc2VsZl9jb250YWluZWQ6IGZhbHNlDQogICAgbGliX2RpcjogImRvY3Mvcm1hcmtkb3duX2xpYnMiDQogIHJtYXJrZG93bjo6aHRtbF92aWduZXR0ZToNCiAgICB0b2M6IHllcw0KICAgIHRvY19kZXB0aDogMg0KZWRpdG9yX29wdGlvbnM6DQogIGNodW5rX291dHB1dF90eXBlOiBjb25zb2xlDQpiaWJsaW9ncmFwaHk6IHV0aWxzL2JpYmxpb2dyYXBoeS5iaWINCmNzbDogdXRpbHMvZjEwMDByZXNlYXJjaC5jc2wNCi0tLQ0KDQoNCjwhLS0gDQohISEhIElNUE9SVEFOVDogcnVuIGBzb3VyY2UoInV0aWxzL3JlbmRlci5SIilgIHRvIHB1Ymxpc2ggaW5zdGVhZCBvZiBjbGlja2luZyBvbiAnS25pdCcNCiMgU2VlIGh0dHBzOi8veWlodWkub3JnL2tuaXRyL29wdGlvbnMvDQotLT4NCg0KYGBge3Igc2V0dXAsIHdhcm5pbmc9RkFMU0UsIG1lc3NhZ2U9VFJVRSwgaW5jbHVkZT1GQUxTRX0NCiMgU2V0IHVwIHRoZSBlbnZpcm9ubWVudA0KDQojIE9wdGlvbnMgcmVsYXRpdmUgdG8gZmlndXJlIHNpemUNCiMgMS42MTggaXMgdGhlIGdvbGRlbiByYXRpbw0KZmlnaGVpZ2h0IDwtIDQNCmZpZ3dpZHRoIDwtIDQgKiAxLjYxOCANCg0KIyBHZW5lcmFsIG9wdGlvbnMNCm9wdGlvbnMoa25pdHIua2FibGUuTkEgPSAiIiwNCiAgICAgICAgbnNtYWxsID0gMywNCiAgICAgICAgdGlkeXZlcnNlLnF1aWV0ID0gVFJVRSkNCg0KIyBDaHVuayBvcHRpb25zIChzZWUgaHR0cHM6Ly95aWh1aS5vcmcva25pdHIvb3B0aW9ucy8jY2h1bmtfb3B0aW9ucykNCmtuaXRyOjpvcHRzX2NodW5rJHNldCgNCiAgY29tbWVudCA9ICI+IiwgICMgVGhlIHByZWZpeCB0byBiZSBhZGRlZCBiZWZvcmUgZWFjaCBsaW5lIG9mIHRoZSB0ZXh0IG91dHB1dC4NCiAgZHBpID0gNjAwLA0KICBmaWcucGF0aCA9ICJmaWd1cmVzLyIsDQogIGZpZy5oZWlnaHQgPSBmaWdoZWlnaHQsDQogIGZpZy53aWR0aCA9IGZpZ3dpZHRoLA0KICBmaWcuYWxpZ24gPSAiY2VudGVyIiwNCiAgIyBTZWUgaHR0cHM6Ly9jb21tdW5pdHkucnN0dWRpby5jb20vdC9jZW50ZXJpbmctaW1hZ2VzLWluLWJsb2dkb3duLXBvc3QvMjA5NjINCiAgIyB0byBsZWFybiBob3cgdG8gY2VudGVyIGltYWdlcw0KICAjIFNlZSBodHRwczovL2Jvb2tkb3duLm9yZy95aWh1aS9ybWFya2Rvd24tY29va2Jvb2svb3B0cy10aWR5Lmh0bWwNCiAgIyBTZWUgaHR0cHM6Ly93d3cuem90ZXJvLm9yZy9zdHlsZXMgZm9yIGNpdGF0aW9uIHN0eWxlIHJlc3Bvc2l0b3J5DQogIHRpZHk9J3N0eWxlcicsDQogIHRpZHkub3B0cz1saXN0KHN0cmljdD1UUlVFKQ0KKQ0KDQpmYXN0IDwtIEZBTFNFICAjIE1ha2UgdGhpcyBmYWxzZSB0byBza2lwIHRoZSBjaHVua3MNCmBgYA0KDQojIEFnZW5kYQ0KDQpUaGlzIGRvY3VtZW50IGhlbHBzIHRvIGV4cGxhaW4gaG93IHRoZSBudW1iZXIgZGlzcGxheWVkIGluIHRoZSBCaW9QQU4gc29mdHdhcmUgYXJlIGNhbGN1bGF0ZWQgdXNpbmcgYSBzbWFsbCBkYXRhc2V0IGFzIGFuIGV4YW1wbGUuIFRoZSBzb3VyY2UgY29kZSBvZiB0aGlzIGRvY3VtZW50IGNhbiBiZSBmb3VuZCBpbiB0aGlzIFtHaXRIdWIgcmVzcG9zaXRvcnldKGh0dHBzOi8vZ2l0aHViLmNvbS9KYXVudHlKSlMvQmlvUEFOX1R1dG9yaWFsKQ0KDQojIEFib3V0IEJpb1BBTg0KDQpbQmlvUEFOXShodHRwczovL2YxMDAwcmVzZWFyY2guY29tL2FydGljbGVzLzEwLTQpIFtAQklPUEFOXSBpcyBhIHRvb2wgZm91bmQgaW4gW0xJUElEIE1BUFNdKGh0dHBzOi8vbGlwaWRtYXBzLm9yZy9iaW9wYW4pIGRlc2lnbmVkIHRvIGF1dG9tYXRlIGJpb3N5bnRoZXRpYyBwYXRod2F5IGFuYWx5c2lzIG9mIGxpcGlkcy4NCg0KIVtdKGZpZ3VyZXMvZ2l6MDYxX0FjdGl2ZVBDdG9QU3RvUEVfcGF0aHdheS5QTkcpDQoNCkJlbG93IGlzIGEgW1lvdVR1YmUgdmlkZW9dKGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9RWZUQ19MdVIzYWspIG9uIGhvdyB0byB1c2UgQmlvUEFOLg0KDQo8cCBhbGlnbj0iY2VudGVyIj4NCjxpZnJhbWUgd2lkdGg9IjU2MCIgaGVpZ2h0PSIzMTUiIHNyYz0iaHR0cHM6Ly93d3cueW91dHViZS5jb20vZW1iZWQvRWZUQ19MdVIzYWsiIGZyYW1lYm9yZGVyPSIwIiBhbGxvd2Z1bGxzY3JlZW4+PC9pZnJhbWU+DQo8L3A+DQoNClRoZSBbZG9jdW1lbnRhdGlvbl0oaHR0cHM6Ly93d3cubGlwaWRtYXBzLm9yZy9iaW9wYW4vZG9jL3N0ZXAzX2J1aWxkLmh0bWwpIG9mIEJpb1BBTiBwcm92aWRlcyBhIHRlY2huaWNhbCBleHBsYW5hdGlvbiBvZiBob3cgdGhlIHBhdGh3YXkgc2NvcmVzIGFyZSBjYWxjdWxhdGVkLg0KDQohW10oZmlndXJlcy9naXowNjFfQmlvUEFOX3RlY2hpbmNhbF9kZXRhaWxzLlBORykNCg0KTW9yZSBpbmZvcm1hdGlvbiBjYW4gYmUgZm91bmQgaW4gdGhpcyBbcGFwZXJdKGh0dHBzOi8vZG9pLm9yZy8xMC4xMDE2L2ouY29wYmlvLjIwMTYuMTAuMDAzKSBbQE5HVVlFTjIwMTc5Nl0NCg0KIyBQYWNrYWdlcw0KDQpgYGB7ciB3YXJuaW5nPUZBTFNFLCBtZXNzYWdlPUZBTFNFLCByZXN1bHRzPSdhc2lzJ30NCmxpYnJhcnkoZHBseXIpDQpsaWJyYXJ5KG1hZ3JpdHRyKQ0KbGlicmFyeShyZXBvcnQpDQpzdW1tYXJ5KHJlcG9ydDo6cmVwb3J0KHNlc3Npb25JbmZvKCkpKQ0KYGBgDQoNCiMgRGF0YSB7LnRhYnNldH0NCg0KYGBge3IgY2hpbGQ9aWYgKGZhc3QgPT0gRkFMU0UpICcxX2Fib3V0X2RhdGEuUm1kJ30NCg0KYGBgDQoNCiMgQmlvUEFOIG9uIExpcGlkIFNwZWNpZXMgey50YWJzZXR9DQoNCmBgYHtyIGNoaWxkPWlmIChmYXN0ID09IEZBTFNFKSAnMl9CaW9QQU5fc3BlY2llc19jYXNlLlJtZCd9DQoNCmBgYA0KDQojIEJpb1BBTiBvbiBMaXBpZCBDbGFzcyB7LnRhYnNldH0NCg0KYGBge3IgY2hpbGQ9aWYgKGZhc3QgPT0gRkFMU0UpICczX0Jpb1BBTl9jbGFzc19jYXNlLlJtZCd9DQoNCmBgYA0KDQojIFJtYXJrZG93biBUZW1wbGF0ZQ0KDQpUaGlzIFJtYXJrZG93biB0ZW1wbGF0ZSBpcyBjcmVhdGVkIGJ5IHRoZSBbUmVhbGl0eSBCZW5kaW5nIExhYl0oaHR0cHM6Ly9yZWFsaXR5YmVuZGluZy5naXRodWIuaW8vKS4gVGhlIHRlbXBsYXRlIGNhbiBiZSBkb3dubG9hZCBmcm9tIHRoZSBsYWIncyBbZ2l0aHViXShodHRwczovL2dpdGh1Yi5jb20vUmVhbGl0eUJlbmRpbmcvVGVtcGxhdGVSZXN1bHRzKSByZXBvc2l0b3J5LiBGb3IgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgbW90aXZhdGlvbiBiZWhpbmQgY3JlYXRpbmcgdGhpcyB0ZW1wbGF0ZSwgY2hlY2sgb3V0IFtEci4gRG9taW5pcXVlIE1ha293c2tpJ3MgYmxvZyBwb3N0XShodHRwczovL2RvbWluaXF1ZW1ha293c2tpLmdpdGh1Yi5pby9wb3N0L3RlbXBsYXRlX3Jlc3VsdHMvKQ0KDQojIFBhY2thZ2UgUmVmZXJlbmNlcw0KYGBge3Igd2FybmluZz1GQUxTRSwgbWVzc2FnZT1UUlVFLCByZXN1bHRzPSdhc2lzJ30NCnJlcG9ydDo6Y2l0ZV9wYWNrYWdlcyhzZXNzaW9uSW5mbygpKQ0KYGBgDQoNCg0KIyBSZWZlcmVuY2VzDQo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("index.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
